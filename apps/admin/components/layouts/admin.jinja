{#css https://cdn.jsdelivr.net/npm/basecoat-css@0.3.10/dist/basecoat.cdn.min.css #}
{#js  https://cdn.jsdelivr.net/npm/basecoat-css@0.3.10/dist/js/all.min.js #}
{#css /static/style.css #}

{#def title="Admin", brand="admin.oornnery.com.br", sidebar_items=None #}

{#import "@ui/ui/button.jinja" as Button #}
{#import "@ui/ui/footer.jinja" as Footer #}
{#import "ui/sidebar.jinja" as Sidebar #}

<!doctype html>
<html lang="pt-BR" class="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{{ title }}</title>
    {{ assets.render_css() }}
  </head>

  <body class="admin-body" data-sidebar="expanded">
    <div class="admin-shell">
      <aside class="admin-sidebar">
        <Sidebar
          title={{ brand }}
          items={{ sidebar_items or [] }}
          active_path={{ request.url.path if request else '' }}
        />
      </aside>

      <div class="admin-main">
        <div class="admin-content">
          <div class="admin-topbar">
            <div>
              <div class="admin-title">{{ title }}</div>
              <div class="admin-subtitle">Gerencie conteúdo e configurações</div>
            </div>

            <div class="admin-topbar-actions">
              <Button href="/api/healthz" variant="outline" size="sm">healthz</Button>
              <Button href="/" variant="primary" size="sm">Dashboard</Button>
            </div>
          </div>

          {{ content }}
        </div>

        <div class="admin-footer">
          <Footer />
        </div>
      </div>
    </div>

    {{ assets.render_js(module=False) }}
    <script>
      (function () {
        var body = document.body;
        var toggle = document.querySelector("[data-sidebar-toggle]");
        if (!toggle) return;

        function applyState(state) {
          body.dataset.sidebar = state;
          toggle.textContent = state === "collapsed" ? ">>" : "<<";
          toggle.setAttribute(
            "aria-label",
            state === "collapsed" ? "Expand sidebar" : "Collapse sidebar"
          );
        }

        var saved = localStorage.getItem("admin-sidebar");
        applyState(saved || body.dataset.sidebar || "expanded");

        toggle.addEventListener("click", function () {
          var next = body.dataset.sidebar === "collapsed" ? "expanded" : "collapsed";
          applyState(next);
          localStorage.setItem("admin-sidebar", next);
        });
      })();
    </script>
  </body>
</html>
