{#def request, user=None, posts=[], categories=[], current_category="", current_tag="" #}
{#import "../layouts/Public.jinja" as PublicLayout #}
{#import "../blog/PostCard.jinja" as PostCard #}
{#import "../ui/Button.jinja" as Button #}
{#import "../ui/Input.jinja" as Input #}

<PublicLayout request={{ request }} user={{ user }} title="Blog" current_page="blog">
    <div class="space-y-6 sm:space-y-8">
        <header>
            <h1 class="text-2xl sm:text-3xl font-bold text-white mb-2">Blog</h1>
            <p class="text-sm sm:text-base text-gray-400">Thoughts, tutorials, and insights about technology and development.</p>
        </header>

        {# Filters #}
        <div class="space-y-3 sm:space-y-4">
            <form hx-get="/posts" hx-target="#posts-grid" hx-trigger="input changed delay:300ms, submit" hx-swap="innerHTML" hx-push-url="false">
                <Input 
                    name="q" 
                    type="search" 
                    placeholder="Search posts..."
                    value={{ current_tag }}
                />
            </form>
            
            {% if categories %}
            <div class="flex flex-wrap gap-1.5 sm:gap-2">
                <a 
                    href="/posts"
                    class="px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm rounded-lg border transition-colors {{ 'bg-gray-800 text-white border-gray-700' if not current_category else 'bg-transparent text-gray-400 border-gray-800 hover:bg-gray-800 hover:text-white' }}"
                >All</a>
                {% for cat in categories %}
                <a 
                    href="/categories/{{ cat }}"
                    class="px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm rounded-lg border transition-colors {{ 'bg-gray-800 text-white border-gray-700' if current_category == cat else 'bg-transparent text-gray-400 border-gray-800 hover:bg-gray-800 hover:text-white' }}"
                >{{ cat }}</a>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        {# Posts Grid #}
        <div id="posts-grid" class="space-y-3 sm:space-y-4">
            {% for post in posts %}
            <PostCard post={{ post }} />
            {% else %}
            <div class="text-center py-8 sm:py-12">
                <p class="text-sm sm:text-base text-gray-500">No posts found.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</PublicLayout>
