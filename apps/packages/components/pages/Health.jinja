{#import "@ui/layouts/Layout.jinja" as Layout #}
{#import "@ui/ui/Card.jinja" as Card #}
{#import "@ui/ui/Button.jinja" as Button #}
{#def
  title="Service health",
  brand="oornnery",
  summary_url="/healthz/summary",
  request=None
#}


<Layout
  title={{ title }}
  brand={{ brand }}
  breadcrumb={{ [
    {'label': 'Home', 'href': '/'},
    {'label': 'Status'}
  ] }}
>
  <Card title="Health checks" description="Live status (aggregated) from services">
    <div class="flex items-center justify-between gap-3">
      <p class="text-sm text-slate-600 dark:text-slate-300">
        Updates automatically. Click on “Logs” for details.
      </p>

      <Button
        variant="secondary"
        hx-get={{ summary_url }}
        hx-target="#healthz-summary"
        hx-swap="innerHTML"
      >
        Update now
      </Button>
    </div>

    <div
      id="healthz-summary"
      class="mt-4"
      hx-get={{ summary_url }}
      hx-trigger="load, every 10s"
      hx-swap="morph:innerHTML"
    >
      <div class="text-sm text-slate-500">Loading status...</div>
    </div>
  </Card>

  {# Portal de modal #}
  <div id="modal-portal"></div>
</Layout>
