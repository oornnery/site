{#import "@ui/ui/Modal.jinja" as Modal #}
{#import "@ui/ui/Button.jinja" as Button #}
{#import "@ui/ui/StatusDot.jinja" as StatusDot #}
{#import "@ui/ui/Badge.jinja" as Badge #}
{#def service=None #}


<Modal title="Logs — {{ service.name }}">
  <div class="flex items-center justify-between gap-3">
    <div class="flex items-center gap-2">
      <StatusDot ok={{ service.ok }} />
      {% if service.ok %}
        <Badge tone="success">OK</Badge>
      {% else %}
        <Badge tone="danger">DOWN</Badge>
      {% endif %}
      <span class="text-sm text-slate-600">{{ service.url }}</span>
    </div>

    <div class="text-xs text-slate-500">
      code: {{ service.code }} • {{ service.datetime or "—" }}
    </div>
  </div>

  <div class="mt-4">
    <label for="logs" class="block text-xs font-medium text-slate-700">
      Logs (updates every 2s while the modal is open)
    </label>

    <textarea
      id="logs"
      class="mt-2 h-64 w-full resize-none rounded-lg border border-slate-200 bg-slate-50 p-3 font-mono text-xs text-slate-800"
      readonly
      hx-get="/healthz/logs?service_id={{ service.id }}"
      hx-trigger="load, every 2s"
      hx-swap="innerHTML"
    >Loading logs...</textarea>
  </div>

  {% slot actions %}
    <Button variant="secondary" x_on:click="open = false">Cancel</Button>
    <Button variant="primary" x_on:click="open = false">OK</Button>
  {% endslot %}
</Modal>
