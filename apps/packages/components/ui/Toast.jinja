{#def message, variant="success", duration=5000 #}
{# Toast notification component with auto-dismiss via JS #}

{% set variant_styles = {
    "success": "bg-green-600 text-white border-green-700",
    "error": "bg-red-600 text-white border-red-700",
    "warning": "bg-amber-500 text-white border-amber-600",
    "info": "bg-blue-600 text-white border-blue-700"
} %}

{% set variant_icons = {
    "success": "&#10003;",
    "error": "&#10007;",
    "warning": "&#9888;",
    "info": "&#8505;"
} %}

<div 
    class="toast flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border animate-slideInRight {{ variant_styles.get(variant, variant_styles['success']) }}"
    role="alert"
    aria-live="polite"
    data-toast
    data-duration="{{ duration }}"
>
    <span class="text-lg">{{ variant_icons.get(variant, variant_icons['success']) | safe }}</span>
    <span class="flex-1 text-sm font-medium">{{ message }}</span>
    <button 
        type="button" 
        class="text-white/80 hover:text-white transition-colors"
        onclick="this.parentElement.remove()"
        aria-label="Dismiss"
    >
        &times;
    </button>
</div>

<style>
@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeOut {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(100%);
    }
}

.animate-slideInRight {
    animation: slideInRight 0.3s ease-out;
}

.toast-exit {
    animation: fadeOut 0.3s ease-out forwards;
}
</style>

<script>
(function() {
    const toast = document.currentScript.previousElementSibling.previousElementSibling;
    if (toast && toast.dataset.toast !== undefined) {
        const duration = parseInt(toast.dataset.duration) || 5000;
        setTimeout(() => {
            toast.classList.add('toast-exit');
            setTimeout(() => toast.remove(), 300);
        }, duration);
    }
})();
</script>
